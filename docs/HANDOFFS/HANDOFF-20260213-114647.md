# Handoff

## Snapshot
- Date (UTC): 2026-02-13T11:46:47Z
- Branch: codex/index-handoff-paid-fallback
- HEAD: 1e9d9b4
- Status:

```text

```

## Objective
1. Add repo-native Index + Handoff tooling to reduce navigation thrash.
2. Finish System-2 FreeComputeCloud paid fallback + resilience hardening:
   - Add OpenAI paid fallback model IDs (chat + mini + codex gated)
   - Keep routing free-first, paid fallback second
   - Add fast timeout handling and fail-closed HTTP status classification
   - Harden Groq secrets shim so `GROQ_API_KEY` is accepted as an alias (no values)

## Progress (Evidence-Based)
- Added paths-only repo index generator (no content reads) and handoff helper scripts.
- Added OpenAI provider entry to FreeComputeCloud catalog plus routing bias to keep it fallback-only.
- ProviderAdapter now fails on non-2xx HTTP responses and labels timeouts deterministically.
- ProviderRegistry retries timeouts once per provider per request and opens circuit on auth/config failures.
- SecretsBridge now propagates `GROQ_API_KEY` alias to `OPENCLAW_GROQ_API_KEY` (and vice versa when injecting).
- Added a secret-safe provider diagnostics script and regression tests for error classification and Groq alias propagation.
- Verified: `npm test` passes.

## Current State
- Index tooling:
  - `node scripts/index/gen_index.mjs` writes `docs/INDEX.md` and `docs/INDEX.json`.
  - `bash scripts/handoff/new_handoff.sh` creates `docs/HANDOFFS/HANDOFF-*.md`.
  - `bash scripts/handoff/print_context.sh` prints a paste-ready safe context bundle.
- FreeComputeCloud paid fallback:
  - Catalog provider: `openai` (OpenAI-compatible) with models:
    - `gpt-5.2-chat-latest`
    - `gpt-5-mini`
    - `gpt-5.3-codex` (gated, default-off)
  - Auth env vars:
    - Primary: `OPENCLAW_OPENAI_API_KEY`
    - Alias: `OPENAI_API_KEY`
  - Groq auth env vars:
    - Primary: `OPENCLAW_GROQ_API_KEY`
    - Alias: `GROQ_API_KEY`
  - Gating:
    - FreeComputeCloud remains disabled unless `ENABLE_FREECOMPUTE_CLOUD=1`.
    - Codex model remains disabled unless `FREECOMPUTE_OPENAI_CODEX_MODEL=1` (avoid shipping a broken default).

## Next Steps
1. Push branch and open PR for review.
2. If/when OpenAI confirms API availability for `gpt-5.3-codex`, revisit the default-off gate decision (keep gated unless proven safe).
3. Optional: add a small operator doc section describing FreeComputeCloud paid fallback env vars and the diagnostics script (names only).

## Verification (Commands + Expected)
```bash
# Index tooling
node scripts/index/gen_index.mjs
bash scripts/handoff/print_context.sh | head -n 80

# FreeComputeCloud regression gates
npm test

# Provider diagnostics (no secret values)
node scripts/system2/provider_diag.js | head -n 50
```

Expected:
- `npm test` prints `OK 15 test group(s)`.
- Diagnostics prints only booleans + env var NAMES (no values).

## Notes / Risks
- `gpt-5.3-codex` API availability is uncertain; it is intentionally gated default-off to avoid breaking paid fallback with provider-wide circuit open on 404/400.
- This change does not wire FreeComputeCloud into any entrypoint beyond existing behavior; it remains default-off unless explicitly enabled.
