{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://openclaw.local/schemas/local_exec/job.schema.json",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "job_id",
    "job_type",
    "created_at_utc",
    "payload",
    "budgets",
    "tool_policy"
  ],
  "properties": {
    "job_id": {
      "type": "string",
      "pattern": "^job-[a-z0-9]{8,32}$"
    },
    "job_type": {
      "type": "string",
      "enum": [
        "repo_index_task",
        "test_runner_task",
        "doc_compactor_task"
      ]
    },
    "created_at_utc": {
      "type": "string",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T"
    },
    "payload": {
      "type": "object",
      "maxProperties": 32
    },
    "budgets": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "max_wall_time_sec",
        "max_tool_calls",
        "max_output_bytes",
        "max_concurrency_slots"
      ],
      "properties": {
        "max_wall_time_sec": {
          "type": "integer",
          "minimum": 1,
          "maximum": 7200
        },
        "max_tool_calls": {
          "type": "integer",
          "minimum": 0,
          "maximum": 500
        },
        "max_output_bytes": {
          "type": "integer",
          "minimum": 1024,
          "maximum": 104857600
        },
        "max_concurrency_slots": {
          "type": "integer",
          "minimum": 1,
          "maximum": 8
        }
      }
    },
    "tool_policy": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "allow_network",
        "allow_subprocess",
        "allowed_tools"
      ],
      "properties": {
        "allow_network": {
          "type": "boolean"
        },
        "allow_subprocess": {
          "type": "boolean"
        },
        "allowed_tools": {
          "type": "array",
          "maxItems": 32,
          "items": {
            "type": "string",
            "maxLength": 64
          }
        }
      }
    },
    "meta": {
      "type": "object",
      "maxProperties": 16
    }
  }
}
