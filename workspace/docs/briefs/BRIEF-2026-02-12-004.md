# Change Brief: FreeCompute Secrets Bridge

## Metadata
- **ID**: BRIEF-2026-02-12-004
- **Category**: B
- **Author**: codex
- **Date**: 2026-02-12
- **Branch**: feature/secrets-bridge

---

## Summary
Add a gated Secrets Bridge to store provider API keys in OS-native secure stores, inject them into the current process environment at runtime, and expose terminal-only operator commands for set/unset/status/test flows.

---

## Operator Usage (Terminal)
```bash
npm run secrets -- set <groq|gemini|openrouter|qwen|vllm>
npm run secrets -- status
npm run secrets -- test <provider>
npm run secrets -- unset <provider>
```

Diagnostics (no secret values):
```bash
node scripts/system2/provider_diag.js
```

Backend defaults:
- macOS: Keychain (`security`)
- Windows: CredentialManager module (explicit file fallback via `SECRETS_BACKEND=file`)
- Linux: Secret Service (`secret-tool`) (explicit file fallback via `SECRETS_BACKEND=file`)

---

## Threat Model Notes
- Secrets are never printed back to the operator.
- Persistence uses keychain/credman/secretservice by default and file backend only with explicit opt-in.
- Runtime uses process-local env injection only; no global system env mutation.
- Operator env vars always win over stored secrets.

---

## Rollback
Operational rollback (no code revert):
- Set `ENABLE_SECRETS_BRIDGE=0`.

Code rollback:
```bash
git revert <secrets-bridge-commit-sha>
```

Secret cleanup:
```bash
npm run secrets -- unset <provider>
```
