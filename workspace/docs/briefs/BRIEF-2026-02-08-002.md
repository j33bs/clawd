# Change Brief: LLM Policy + Token Budget Enforcement

## Metadata
- **ID**: BRIEF-2026-02-08-002
- **Category**: C
- **Author**: codex
- **Date**: 2026-02-08
- **Branch**: develop

---

## Summary
Add a canonical LLM policy file and enforce token/call budgets and routing for the ITC classifier to reduce token burn and avoid rate limits.

---

## Motivation
Repeated rate-limit failures indicate uncontrolled LLM usage. A simple, explicit policy enables deterministic routing and budgeting without adding speculative ML.

---

## Risk Assessment

### Reversibility
- [x] Easy - Can revert with single commit
- [ ] Moderate - Requires multiple steps to revert
- [ ] Hard - May have cascading effects

### Blast Radius
Classifier pipeline and documentation only.

| File | Change Type |
|------|-------------|
| `workspace/policy/llm_policy.json` | Create |
| `scripts/itc_classify.py` | Modify |
| `workspace/MODEL_ROUTING.md` | Modify |
| `workspace/scripts/verify_llm_policy.sh` | Create |
| `workspace/scripts/verify.sh` | Modify |

### Security Impact
- [ ] None - No security implications
- [x] Low - Minor security consideration
- [ ] Medium - Security review required
- [ ] High - Affects authentication, authorization, or data protection

---

## Files Touched

| File | Action | Rationale |
|------|--------|-----------|
| `workspace/policy/llm_policy.json` | CREATE | Canonical policy and budgets |
| `scripts/itc_classify.py` | MODIFY | Enforce policy + budgets |
| `workspace/MODEL_ROUTING.md` | MODIFY | Document policy |
| `workspace/scripts/verify_llm_policy.sh` | CREATE | Policy validation |
| `workspace/scripts/verify.sh` | MODIFY | Include policy check |

---

## Implementation Plan

1. Create `workspace/policy/llm_policy.json` with budgets + routing order.
2. Enforce policy in `scripts/itc_classify.py` (budgets, routing, prefer-local).
3. Add verification script and integrate into pre-admission verify.
4. Update model routing documentation.

---

## Rollback Plan

Revert the commit.

```bash
git revert <commit>
```

---

## Regression Scope

### Automated Validation
- [x] Must pass: `scripts/regression.sh`
- [x] Must pass: `scripts/verify.sh`

### Manual Checks
- [ ] Run `python scripts/itc_classify.py --rules-only` to confirm rules still work

---

## Admission Checklist

- [ ] Brief complete with all sections filled
- [ ] Branch created with correct prefix
- [ ] Implementation follows existing patterns
- [ ] Regression validation passed
- [ ] No secrets in diff
- [ ] Category/branch aligned
- [ ] Governance log entry prepared (for Category A/B)
- [ ] Rollback plan tested (for Category A/B)

---

## Notes

Budgets are conservative defaults and can be adjusted in policy without code changes.

---

*Template version: 1.0*
*See CONTRIBUTING.md for category definitions and admission process.*
