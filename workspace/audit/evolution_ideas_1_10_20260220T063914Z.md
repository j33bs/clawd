# Evolution Ideas 1-10 Audit

- UTC: 20260220T063914Z
- Branch: codex/feature/evolution-ideas-1-10-20260220

## Idea 1 — Synaptic Pruning

- Files changed:
  - `workspace/tacti_cr/dream_consolidation.py`
  - `tests_unittest/test_dream_consolidation_pruning.py`
- Flags:
  - `OPENCLAW_DREAM_PRUNING` (new)
  - `OPENCLAW_DREAM_PRUNE` (compat alias)
- Notes:
  - Added deterministic competitive strength scoring (mass * recency * reinforcement_count).
  - Added essence absorption (exemplars/tags/provenance) and accelerated weak-cluster decay with min-mass pruning.

### Commands

```bash
python3 -m unittest -q tests_unittest/test_dream_consolidation_pruning.py tests_unittest/test_evolution_scaffolds.py
```

Output: `Ran 10 tests ... OK`

## Idea 2 — Proprioceptive Feedback Loops

- Files changed:
  - `workspace/scripts/proprioception.py`
  - `workspace/scripts/policy_router.py`
  - `tests_unittest/test_router_proprioception.py`
- Flag:
  - `OPENCLAW_ROUTER_PROPRIOCEPTION`
- Notes:
  - Added throughput proxies (`throughput_tokens_per_sec_*`, `elapsed_ms_per_token_p50`) to sampler snapshots.
  - Added `tacti_arousal_from_proprioception(...)` and fed it into expression/arousal control context as first-class `arousal` input.

### Commands

```bash
python3 -m unittest -q tests_unittest/test_router_proprioception.py tests_unittest/test_policy_router_tacti_main_flow.py
```

Output: `Ran 7 tests ... OK`

## Ideas 3–5 — Trails Valence, Temporal Surprise Gate, Peer Annealing

- Files changed:
  - `workspace/hivemind/hivemind/trails.py`
  - `workspace/tacti_cr/temporal.py`
  - `workspace/hivemind/hivemind/peer_graph.py`
  - `tests_unittest/test_trails_valence.py`
  - `tests_unittest/test_temporal_surprise_gate.py`
  - `tests_unittest/test_peer_graph_anneal.py`
- Flags (new aliases are backward-compatible):
  - `OPENCLAW_TRAILS_VALENCE` (+ `OPENCLAW_TRAIL_VALENCE`)
  - `OPENCLAW_TEMPORAL_SURPRISE_GATE` (+ `OPENCLAW_SURPRISE_GATE`)
  - `OPENCLAW_PEERGRAPH_ANNEAL` (+ `OPENCLAW_PEER_ANNEAL`)
- Notes:
  - Added `TrailStore.deposit(..., valence=...)` and `TrailStore.follow(...)` with dampened inheritance and deterministic consensus aggregation.
  - Switched surprise proxy to KL divergence over normalized synthetic distributions with optional EMA threshold adaptation.
  - Added annealing `session_step` schedule and temperature-aware churn acceptance.

### Commands

```bash
python3 -m unittest -q tests_unittest/test_trails_valence.py tests_unittest/test_hivemind_trails.py tests_unittest/test_temporal_surprise_gate.py tests_unittest/test_tacti_cr_temporal.py tests_unittest/test_peer_graph_anneal.py tests_unittest/test_hivemind_peer_graph.py tests_unittest/test_evolution_scaffolds.py
```

Output: `Ran 25 tests ... OK`

## Ideas 6–10 — Narrative Distill, Counterfactual Replay, Epitopes, Oscillatory Attention, Witness Ledger

- Files changed:
  - `workspace/scripts/narrative_distill.py`
  - `workspace/scripts/run_narrative_distill.py`
  - `workspace/hivemind/hivemind/active_inference.py`
  - `workspace/tacti_cr/semantic_immune.py`
  - `workspace/tacti_cr/oscillatory_gating.py`
  - `workspace/scripts/witness_ledger.py`
  - `workspace/scripts/policy_router.py`
  - `tests_unittest/test_narrative_distill.py`
  - `tests_unittest/test_active_inference_counterfactual.py`
  - `tests_unittest/test_semantic_immune_epitopes.py`
  - `tests_unittest/test_oscillatory_attention.py`
  - `tests_unittest/test_witness_ledger.py`
- Flags:
  - `OPENCLAW_NARRATIVE_DISTILL`
  - `OPENCLAW_AIF_COUNTERFACTUAL` (+ `OPENCLAW_COUNTERFACTUAL_REPLAY`)
  - `OPENCLAW_SEMANTIC_IMMUNE_EPITOPES` (+ `OPENCLAW_EPITOPE_CACHE`)
  - `OPENCLAW_OSCILLATORY_ATTENTION` (+ `OPENCLAW_OSCILLATORY_GATING`)
  - `OPENCLAW_WITNESS_LEDGER`
- Notes:
  - Distillation now emits deterministic timestamps and idempotent semantic writes via stable semantic keys.
  - Added `replay_counterfactuals(event, k=3, rng_seed=None)` with deterministic phantom updates and no external calls.
  - Added bounded `EpitopeCache` class and alias-gated fast match path.
  - Added phase scheduler (`PhaseScheduler.should_run(...)`) while preserving `OscillatoryGate` compatibility output shape.
  - Added witness chain verification utility (`verify_chain`) and tamper detection coverage.

### Commands

```bash
python3 -m unittest -q tests_unittest/test_narrative_distill.py tests_unittest/test_active_inference_counterfactual.py tests_unittest/test_semantic_immune_epitopes.py tests_unittest/test_oscillatory_attention.py tests_unittest/test_witness_ledger.py tests_unittest/test_evolution_scaffolds.py
```

Output: `Ran 21 tests ... OK`

